<p-confirmDialog [style]="{width: '450px'}" [appendTo]="'body'" [blockScroll]="false"></p-confirmDialog>
<div class="max-w-7xl mx-auto px-4 py-6">
    <!-- Header -->
    <div class="mb-6">
        <h1 class="text-2xl font-semibold text-slate-800">Boarding Management</h1>
    </div>

    <!-- Filters & Stats -->
    <div class="bg-white rounded p-4 shadow-sm border border-slate-200 mb-4">
        <div class="flex items-center justify-between flex-wrap gap-4">

            <!-- Date Picker -->
            <div class="flex items-center gap-3">
                <label class="text-sm font-medium text-slate-700">Travel Date:</label>
                <p-datepicker [(ngModel)]="selectedDate" (ngModelChange)="onDateChange($event)" [showIcon]="true"
                    dateFormat="dd/mm/yy" placeholder="Select date" [showButtonBar]="true" />
            </div>

            <!-- Stats -->
            <div class="flex items-center gap-6 text-sm">
                <div>
                    <span class="text-slate-600">Total:</span>
                    <span class="font-semibold text-slate-800 ml-1">{{ totalCount }}</span>
                </div>
                <div>
                    <span class="text-slate-600">Boarded:</span>
                    <span class="font-semibold text-emerald-600 ml-1">{{ boardedCount }}</span>
                </div>
                <div>
                    <span class="text-slate-600">Pending:</span>
                    <span class="font-semibold text-amber-600 ml-1">{{ pendingCount }}</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Table -->
    <div class="bg-white rounded shadow-sm border border-slate-200 overflow-x-auto">
        <!-- Empty State -->
        <div *ngIf="boardingRows.length === 0" class="text-center py-12">
            <p class="text-slate-600">No bookings found for selected date</p>
        </div>

        <!-- Table -->
        <p-table *ngIf="boardingRows.length > 0" [value]="boardingRows" [paginator]="true" [rows]="10"
            [rowsPerPageOptions]="[10, 25, 50]" paginatorDropdownAppendTo="body" styleClass="p-datatable-sm">
            <!-- Table Header -->
            <ng-template pTemplate="header">
                <tr>
                    <th style="width: 4rem" class="text-center font-semibold text-slate-600">Seq</th>
                    <th class="font-semibold text-slate-600 uppercase text-xs tracking-wider">Booking ID</th>
                    <th class="font-semibold text-slate-600">Seats</th>
                    <th class="font-semibold text-slate-600">Mobile</th>
                    <th style="width: 100px" class="text-center font-semibold text-slate-600">Action</th>
                </tr>
            </ng-template>

            <!-- Table Body -->
            <ng-template pTemplate="body" let-row>
                <tr [class.row-boarded]="row.boarded" class="border-b border-slate-100 transition-colors duration-200">
                    <!-- Sequence -->
                    <td class="text-center font-semibold text-slate-600">
                        <span class="md:hidden font-medium text-slate-500 mr-2">Seq:</span>
                        {{ row.sequence }}
                    </td>

                    <!-- Booking ID -->
                    <td class="font-mono text-slate-600 text-sm">
                        <span class="md:hidden font-medium text-slate-500 mr-2">Booking ID:</span>
                        <span class="md:hidden">..{{ row.id | slice:-4 }}</span>
                        <span class="hidden md:inline">{{ row.id }}</span>
                    </td>

                    <!-- Seats -->
                    <td class="font-bold text-slate-800 text-sm">
                        <span class="md:hidden font-medium text-slate-500 mr-2">Seats:</span>
                        {{ formatSeats(row.seats) }}
                    </td>

                    <!-- Mobile -->
                    <td>
                        <span class="md:hidden font-medium text-slate-500 mr-2">Mobile:</span>
                        <a [href]="'tel:' + row.mobileNumber"
                            class="flex items-center gap-2 text-slate-600 hover:text-red-600 text-sm font-medium whitespace-nowrap inline-flex">
                            <i class="pi pi-phone text-xs text-red-500"></i>
                            {{ row.mobileNumber }}
                        </a>
                    </td>

                    <!-- Action Button -->
                    <td class="relative z-10 text-center p-1">
                        <div class="boarding-action-btn w-full bg-transparent pointer-events-auto">
                            <!-- Board Button (Red) -->
                            <button *ngIf="!row.boarded" type="button"
                                class="p-button p-component p-button-danger p-button-sm w-full font-semibold text-xs justify-center boarding-btn-native h-8 px-2"
                                (click)="onToggleBoarding(row); $event.stopPropagation()">
                                <span>Board</span>
                            </button>

                            <!-- Boarded Button (Green Outlined) -->
                            <button *ngIf="row.boarded" type="button"
                                class="p-button p-component p-button-success p-button-outlined p-button-sm w-full font-semibold text-xs justify-center boarding-btn-native h-8 px-2"
                                (click)="onToggleBoarding(row); $event.stopPropagation()">
                                <i class="pi pi-check text-xs mr-1"></i>
                                <span>Boarded</span>
                            </button>
                        </div>
                    </td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</div>